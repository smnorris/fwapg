Search.setIndex({"docnames": ["01_setup", "02_usage", "03_tables", "04_functions", "index"], "filenames": ["01_setup.md", "02_usage.md", "03_tables.md", "04_functions.md", "index.rst"], "titles": ["Setup and data load", "Usage", "Table reference", "Function reference", "fwapg"], "terms": {"postgresql": [0, 1, 4], "13": 0, "postgi": [0, 1, 4], "v3": 0, "1": [0, 1, 2, 3], "geo": 0, "3": [0, 2, 3], "9": 0, "gdal": 0, "test": 0, "5": [0, 1, 3], "python": 0, "bcdata": 0, "0": [0, 1, 3], "6": 0, "gnu": 0, "parallel": 0, "make": [0, 1, 3], "unzip": 0, "wget": [0, 1], "etc": 0, "The": [0, 1, 2, 3], "instruct": 0, "below": [0, 1], "presum": [0, 1], "abov": [0, 1, 2, 3], "requir": [0, 2, 3], "ar": [0, 1, 2, 3], "instal": [0, 1], "postgr": 0, "accept": [0, 1], "connect": [0, 2], "If": [0, 1, 3], "you": [0, 1, 3], "an": [0, 1, 2, 3], "exist": [0, 1, 2], "new": 0, "one": [0, 1, 2], "adjust": [0, 1], "name": [0, 1, 2, 3], "createdb": 0, "fwapg": [0, 1, 2, 3], "script": 0, "database_url": [0, 1], "set": [0, 1, 3], "order": [0, 1, 2, 3], "For": [0, 1, 2, 3], "exampl": [0, 1], "export": 0, "db": 0, "5432": 0, "To": [0, 1], "confirm": 0, "can": [0, 1, 2], "thi": [0, 1, 2, 3], "start": 0, "psql": 0, "first": [0, 1, 3], "argument": [0, 1], "type": [0, 1, 2, 3], "help": 0, "get": 0, "either": [0, 3], "download": [0, 1], "latest": 0, "releas": 0, "develop": 0, "version": 0, "git": 0, "clone": 0, "http": [0, 1], "github": 0, "com": 0, "smnorri": 0, "optim": 0, "cd": 0, "given": [0, 3], "spatial": [0, 1, 2, 4], "fwa": [0, 1, 2, 3, 4], "tabl": [0, 1, 3, 4], "sequenc": 0, "featur": [0, 1, 2, 3, 4], "from": [0, 1, 2, 3, 4], "openmap": 0, "gov": 0, "bc": [0, 1, 2, 3, 4], "ca": [0, 1], "wf": 0, "servic": [0, 1], "5k": 0, "chunk": 0, "geojson": 0, "respons": 0, "temp": 0, "schema": 0, "singl": [0, 3], "jsonb": 0, "column": [0, 1, 2, 3], "output": [0, 1, 2, 3], "copi": 0, "translat": [0, 1, 4], "chang": 0, "whse_basemap": [0, 1, 2, 3], "note": [0, 1, 2, 3], "time": [0, 2], "larger": 0, "veri": [0, 1], "slow": [0, 3], "full": [0, 1, 3], "take": 0, "sever": [0, 3], "hour": 0, "howev": [0, 1], "onc": [0, 1], "complet": [0, 1], "have": [0, 1, 2, 3], "up": [0, 1, 3], "date": 0, "readi": 0, "speedi": [0, 3, 4], "queri": [0, 2, 3, 4], "No": 0, "track": 0, "sourc": [0, 1, 2, 3], "avail": [0, 1], "appli": 0, "refresh": 0, "drop": [0, 3], "all": [0, 1, 2, 3], "manag": 0, "function": [0, 1, 2, 4], "re": 0, "clean_target": 0, "clean_db": 0, "background": 0, "specif": 0, "remov": 0, "placehold": 0, "file": 0, "rm": 0, "fwa_stream_networks_sp": [0, 1, 2, 3], "c": [0, 1, 3], "alter": 0, "contain": [0, 3], "geometri": [0, 1, 2, 3], "ie": [0, 1, 3], "databc": 0, "server": 0, "guarante": 0, "without": [0, 1], "code": [0, 2, 3], "20k": [0, 1], "50k": [0, 1], "lookup": [0, 1, 2, 3], "geobc": 0, "ftp": 0, "site": [0, 1, 3], "thu": [0, 1], "onli": [0, 1, 2, 3], "current": [0, 2], "public": 0, "fwa_bc": 0, "zip": 0, "document": [1, 2], "work": [1, 2], "familiar": 1, "data": [1, 2, 3, 4], "sql": [1, 4], "most": [1, 3], "typic": 1, "us": [1, 2, 3], "answer": 1, "question": 1, "what": [1, 3], "interest": 1, "befor": [1, 3], "we": [1, 2, 3], "link": [1, 2], "simpli": 1, "locat": [1, 3, 4], "x": [1, 3, 4], "y": [1, 3, 4], "plu": [1, 3], "coordin": 1, "system": [1, 2], "identifi": [1, 2, 3], "fwa_indexpoint": [1, 4], "find": [1, 2, 3], "nearest": [1, 3], "123": [1, 3], "7028": [1, 3], "48": [1, 3], "3858": [1, 3], "select": [1, 2, 3], "4326": [1, 3], "snap": [1, 3], "input": [1, 3], "closest": [1, 3], "return": [1, 3], "inform": [1, 2], "about": 1, "minimum": 1, "distanc": [1, 3], "linear_feature_id": [1, 2, 3], "gnis_nam": [1, 2, 3], "wscode_ltre": [1, 2, 3], "localcode_ltre": [1, 2, 3], "blue_line_kei": [1, 2, 3, 4], "downstream_route_measur": [1, 2, 3], "distance_to_stream": [1, 3], "bc_ind": [1, 3], "geom": [1, 2, 3], "710513719": [1, 3], "sook": [1, 3], "river": [1, 2, 3], "930": [1, 3], "023810": [1, 3], "354153927": [1, 3], "350": [1, 3], "2530543284006": [1, 3], "24": [1, 3], "228": [1, 3], "t": [1, 3], "via": [1, 2, 4], "experi": 1, "directli": [1, 2], "anyth": 1, "other": [1, 3], "than": [1, 2], "web": 1, "browser": 1, "zoom": [1, 3], "out": 1, "see": [1, 2], "context": 1, "default": [1, 3], "map": [1, 2, 3], "referenc": [1, 3], "handi": 1, "necessari": 1, "join": [1, 2, 3], "entir": [1, 3], "environ": [1, 4], "canada": 1, "hydrometr": 1, "station": 1, "dataset": 1, "csv": 1, "dd": 1, "weather": 1, "gc": 1, "doc": [1, 2], "hydrometric_stationlist": 1, "clean": 1, "header": 1, "sed": 1, "1s": 1, "id": [1, 2, 3], "lat": [1, 3], "lon": [1, 3], "prov": 1, "timezon": 1, "hydrostn": 1, "creat": [1, 3, 4], "alber": [1, 3], "valu": [1, 3, 4], "ogr2ogr": 1, "s_sr": 1, "epsg": 1, "t_sr": 1, "3005": [1, 2, 3], "f": 1, "pg": 1, "lco": 1, "geometry_nam": 1, "oo": 1, "x_possible_nam": 1, "y_possible_nam": 1, "keep_geom_column": 1, "NO": 1, "where": [1, 3], "nln": 1, "becaus": [1, 2], "match": [1, 3], "done": 1, "later": [1, 3], "just": 1, "five": 1, "pt": [1, 3], "limit": 1, "left": [1, 2, 3], "100": [1, 3], "10": [1, 3], "within": [1, 2, 3], "100m": [1, 3], "i": [1, 3], "ON": [1, 2, 3], "true": [1, 3], "07ea004": [1, 3], "ingenika": [1, 3], "swannel": 1, "359571145": [1, 3], "6095": 1, "5541123470175": 1, "41": [1, 3], "466": 1, "359233576": [1, 3], "47": [1, 3], "233": 1, "07ea005": [1, 3], "finlai": [1, 3], "aki": [1, 3], "359569942": [1, 3], "42909": [1, 3], "470879005145": 1, "372": 1, "07ea007": [1, 3], "NEAR": 1, "THE": 1, "760": 1, "m": [1, 3], "contour": 1, "359571761": [1, 3], "29215": [1, 3], "311821971634": 1, "002": 1, "07eb002": [1, 3], "ospika": [1, 3], "alei": 1, "creek": 1, "359573063": [1, 3], "29005": [1, 3], "40894424251": 1, "42": 1, "77": [1, 3], "07ec002": [1, 3], "omineca": [1, 3], "osilinka": 1, "359571933": [1, 3], "29316": 1, "915466924725": 1, "95": [1, 3], "172": 1, "variabl": [1, 4], "precis": [1, 2, 3], "accuraci": 1, "challeng": 1, "In": 1, "ha": [1, 2, 3], "two": [1, 3], "50m": [1, 3], "which": [1, 3], "correct": 1, "95m": 1, "too": 1, "far": 1, "confid": 1, "qualiti": 1, "essenti": 1, "content": 1, "lineag": 1, "Is": 1, "ani": 1, "improv": [1, 3], "how": [1, 3], "were": 1, "collect": [1, 3], "These": [1, 2], "like": [1, 3], "digit": 1, "paper": 1, "much": 1, "differ": [1, 2], "scale": 1, "20": [1, 3], "000": [1, 3], "reliabl": 1, "consist": [1, 2], "appear": 1, "base": [1, 2, 3], "extens": 1, "IF": 1, "NOT": [1, 3], "pg_trgm": 1, "text": [1, 2, 3], "trgm_comparison": 1, "good": 1, "enough": [1, 3], "accord": 1, "should": [1, 3], "produc": 1, "more": 1, "filter": [1, 3], "fals": [1, 3], "string": 1, "comparison": 1, "still": [1, 3], "error": 1, "prone": 1, "list": [1, 3], "would": [1, 3], "happen": 1, "swanel": 1, "wa": [1, 3], "ensur": 1, "subsequ": 1, "manual": 1, "qa": 1, "ed": 1, "possibl": [1, 3], "attribut": [1, 3], "could": 1, "includ": [1, 2, 3], "50": [1, 3], "provid": [1, 2, 3, 4], "between": [1, 3], "channel": [1, 3], "width": 1, "similar": 1, "compar": [1, 3], "1m": 1, "5th": 1, "addit": [1, 3, 4], "mai": [1, 3], "best": 1, "whatev": 1, "toler": [1, 2, 3], "your": 1, "cut": [1, 3], "down": 1, "hold": 1, "hydrostn_ev": 1, "AS": [1, 3], "BY": [1, 3], "determin": 1, "route_measur": 1, "user": 1, "guid": 1, "hierarch": 1, "kei": [1, 2, 3], "abil": 1, "process": [1, 3], "both": 1, "databas": [1, 3, 4], "store": [1, 2], "trail": 1, "000000": 1, "fill": 1, "143": 1, "charact": [1, 2], "ltree": [1, 2, 3], "easier": 1, "search": 1, "tree": 1, "structur": 1, "variou": [1, 2], "while": 1, "modul": 1, "oper": 1, "simpl": 1, "hierarchi": 1, "eg": [1, 2], "ancestor": 1, "right": 1, "equal": [1, 3], "quit": 1, "descend": [1, 3], "therefor": 1, "fwa_upstream": [1, 4], "fwa_downstream": [1, 4], "simpler": 1, "enabl": [1, 3, 4], "do": [1, 3], "e": 1, "sum": [1, 3], "st_length": [1, 3], "s": [1, 2, 3, 4], "1000": [1, 3], "length_dnstr_km": [1, 3], "inner": [1, 2, 3], "group": [1, 2, 3], "908": 1, "3217090864651": 1, "996": 1, "3101858316527": 1, "1011": 1, "4124142994692": 1, "834": 1, "4111401643679": 1, "778": 1, "6774554185706": 1, "portion": 1, "present": [1, 3], "columbia": [1, 4], "basin": [1, 2], "almost": 1, "same": [1, 3], "length_upstr_km": 1, "8355": 1, "325367888996": 1, "41388": 1, "6738526307": 1, "4999": 1, "9129992270255": 1, "5907": 1, "417221603829": 1, "10042": 1, "880207799402": 1, "As": [1, 3], "incorrect": 1, "tran": 1, "boundari": [1, 2, 3, 4], "well": 1, "hope": [1, 3], "count": [1, 3], "356364114": [1, 3], "160400": [1, 3], "113848": [1, 3], "83": 1, "isol": 1, "dam": [1, 3], "bennet": [1, 3], "length_km": 1, "359572348": [1, 3], "1597489": [1, 3], "200": [1, 3], "948755": [1, 3], "816999": 1, "AND": [1, 3], "1706733": [1, 3], "871814": 1, "28974": 1, "584934736216": 1, "With": 1, "hand": 1, "now": 1, "seem": 1, "straightforward": 1, "fundament": [1, 2, 3], "aggreg": [1, 2, 3], "them": [1, 3], "extract": [1, 3], "08ha002": 1, "polygon": [1, 2, 3], "unalt": 1, "linework": 1, "p": 1, "st_union": 1, "w": 1, "fwa_watersheds_poli": 1, "successfulli": 1, "But": 1, "look": [1, 3], "close": 1, "bit": 1, "might": 1, "expect": 1, "local_watershed_cod": [1, 3], "920": 1, "252823": 1, "584332": 1, "three": 1, "highlight": 1, "lower": [1, 3], "found": 1, "waterbodi": [1, 2], "defin": [1, 2, 3], "complex": 1, "rule": [1, 3], "issu": 1, "fwa_watershedatmeasur": [1, 2, 4], "paramet": 1, "354155148": [1, 3], "49129": [1, 3], "75": [1, 3], "also": [1, 3], "when": [1, 2], "run": [1, 2], "each": [1, 3], "resourc": [1, 2, 3], "intens": [1, 2], "want": [1, 3], "restrict": 1, "line": [2, 3], "latitud": 2, "longitud": 2, "49n": 2, "60n": 2, "120w": 2, "cross": [2, 3, 4], "border": 2, "stream": [2, 3, 4], "descript": 2, "approx_border_id": 2, "integ": [2, 3], "uniqu": [2, 3], "identif": 2, "A": [2, 3], "usa49": 2, "ytnwt_60": 2, "ab_120": 2, "linestr": 2, "some": 2, "workflow": 2, "relat": 2, "fwa_assessment_watersheds_poli": 2, "watersh": [2, 3, 4], "There": 2, "maintain": 2, "rather": 2, "everi": [2, 4], "watershed_feature_id": 2, "assmnt_watershed_id": 2, "watershed_group_cod": 2, "watershed_group_id": 2, "segment": 2, "larg": 2, "least": 2, "2": [2, 3], "pre": 2, "basin_id": 2, "basin_nam": 2, "thompson": 2, "associ": 2, "outlet": [2, 3], "local": [2, 3], "bcboundary_id": 2, "per": 2, "simplifi": 2, "25m": 2, "primarili": 2, "named_streams_id": 2, "bcgni": 2, "geograph": 2, "bigint": [2, 3], "blue": [2, 3], "stream_ord": 2, "maximum": [2, 3], "multilinestr": 2, "simpifi": 2, "conveni": 2, "quickli": [2, 4], "lake": [2, 3], "wetland": 2, "manmad": 2, "glacier": 2, "meant": 2, "purpos": 2, "network": [2, 3, 4], "999": 2, "999999": 2, "exclud": 2, "waterbody_kei": [2, 3], "waterbody_typ": 2, "vari": 2, "doubl": [2, 3], "area": [2, 3], "reservoir": [2, 3], "upstream": [2, 3, 4], "individu": 2, "nest": 2, "accur": 2, "contribut": [2, 3], "drainag": 2, "outsid": 2, "upstream_lake_ha": 2, "upstream_reservoir_ha": 2, "upstream_wetland_ha": 2, "indic": [2, 3], "ua": 2, "upstream_area_ha": 2, "outer": 2, "l": [2, 3], "wscode": 3, "localcod": 3, "b": 3, "include_equival": 3, "boolean": 3, "001": 3, "measur": [3, 4], "downstream": [3, 4], "shorter": 3, "form": 3, "point": [3, 4], "specifi": 3, "evalu": 3, "exactli": 3, "linear": [3, 4], "posit": [3, 4], "At": 3, "its": 3, "basic": 3, "pair": 3, "second": 3, "parent": 3, "100000": 3, "000100": 3, "known": 3, "total": 3, "length": 3, "result": 3, "side": 3, "necessarili": 3, "ocean": 3, "round": 3, "numer": 3, "308": 3, "54": 3, "refin": 3, "slightli": 3, "along": 3, "fraser": 3, "mainstem": 3, "watershed_kei": 3, "161": 3, "40": 3, "record": 3, "arrai": 3, "fish": 3, "passag": 3, "field": 3, "assess": 3, "bcfishpass": 3, "aggregated_crossings_id": 3, "array_agg": 3, "dam_id": 3, "downstream_dam_id": 3, "stream_crossing_id": 3, "IS": 3, "null": 3, "4790": 3, "2343": 3, "69233": 3, "917": 3, "1801": 3, "2165": 3, "2310": 3, "5468": 3, "2472": 3, "125252": 3, "15": 3, "97": 3, "213": 3, "1917": 3, "5697": 3, "176": 3, "576": 3, "426": 3, "float": 3, "5000": 3, "num_featur": 3, "srid": 3, "rout": 3, "metr": 3, "number": 3, "5000m": 3, "0101000020bd0b0000d579287b42dc314198937d515c061741": 3, "index": [3, 4], "st_setsrid": 3, "st_makepoint": 3, "1054676": 3, "1304723": 3, "1045356": 3, "1348750": 3, "1066334": 3, "1356262": 3, "1126747": 3, "1283184": 3, "1089342": 3, "1214473": 3, "68051401": 3, "992594": 3, "039418": 3, "6096": 3, "256539019577": 3, "319": 3, "0101000020bd0b00007ffbc4c0c617304173bf3d23bae83341": 3, "68051402": 3, "042767": 3, "46": 3, "0101000020bd0b000023dbf9feb11730413108ac1cb3e83341": 3, "49095881": 3, "999851": 3, "137838": 3, "36746325051": 3, "258": 3, "0101000020bd0b0000c3f5289c79e62f41508d976e90943441": 3, "49083226": 3, "088011": 3, "231827": 3, "40257114563": 3, "442": 3, "0101000020bd0b000037b9e4f44b4530410ddf6acec1b13441": 3, "161051216": 3, "951156": 3, "201899": 3, "449548147713": 3, "647": 3, "0101000020bd0b0000d7d491c73f3131419708ad7a50943341": 3, "115033725": 3, "944288": 3, "110746": 3, "29317": 3, "40902691083": 3, "125": 3, "0101000020bd0b000054618dd09a9f3041a0d25c29f4873241": 3, "correspond": 3, "25": 3, "skeena": 3, "st_astext": 3, "distinct": 3, "25000": 3, "zm": 3, "754013": 3, "9457165595": 3, "1029911": 3, "1568720527": 3, "start_measur": 3, "interval_length": 3, "end_measur": 3, "repres": 3, "interv": 3, "1km": 3, "peac": 3, "1314468": 3, "0708699157": 3, "1256099": 3, "567354601": 3, "412": 3, "98247677532964": 3, "1598489": 3, "1313779": 3, "3421101477": 3, "1256817": 3, "5566858777": 3, "413": 3, "709000000003": 3, "1599489": 3, "1313217": 3, "588407995": 3, "1257612": 3, "8656611862": 3, "9290255060764": 3, "1600489": 3, "1312633": 3, "1479665248": 3, "1258419": 3, "2668507479": 3, "414": 3, "request": 3, "10km": 3, "z": 3, "mvt": [3, 4], "stream_order_max": 3, "level": 3, "fast": 3, "displai": 3, "show": 3, "higher": 3, "pg_tileserv": [3, 4], "modest": 3, "tile": [3, 4], "low": 3, "render": 3, "gener": [3, 4], "behind": 3, "cach": 3, "wscode_ltree_a": 3, "localcode_ltree_a": 3, "wscode_ltree_b": 3, "localcode_ltree_b": 3, "blue_line_key_a": 3, "downstream_route_measure_a": 3, "upstream_route_measure_a": 3, "blue_line_key_b": 3, "downstream_route_measure_b": 3, "upstream_route_measur": 3, "mission": 3, "terzaghi": 3, "bridg": 3, "n_lake": 3, "fwa_lakes_poli": 3, "fwa_waterbodi": [3, 4], "wb": 3, "239855": 3, "240724": 3, "998": 3, "row": 3, "upstream_dam_id": 3, "69195": 3, "163": 3, "196198": 3, "1427": 3, "2362": 3, "195590": 3, "1914": 3, "51959": 3, "2371": 3, "103090": 3, "1085": 3, "1693": 3, "1483": 3, "103088": 3, "7520": 3, "416": 3, "1129": 3, "708": 3, "1937": 3, "1128": 3, "delin": 3, "follow": 3, "prioriti": 3, "everyth": 3, "outflow": 3, "canal": 3, "across": 3, "bank": 3, "being": 3, "top": 3, "fall": 3, "bottom": 3, "non": 3, "usg": 3, "huc12": 3, "usa": 3, "mt": 3, "hydrosh": 3, "neighbour": [3, 4], "jurisdict": [3, 4], "area_ha": 3, "hectar": 3, "refine_method": 3, "further": 3, "dem": 3, "li": 3, "valuabl": 3, "equival": 3, "keep": 3, "retain": 3, "cowichan": 3, "hwy": 3, "19": 3, "chilliwack": 3, "WITH": 3, "indexed_pt": 3, "st_pointonsurfac": 3, "gnis_name_1": 3, "064535": 3, "057628": 3, "634957": 3, "33478": 3, "28": 3, "height": 3, "land": 3, "extend": 4, "british": 4, "freshwat": 4, "atla": 4, "arbitrari": 4, "refer": 4, "throughout": 4, "cleanli": 4, "combin": 4, "gradient": 4, "serv": 4, "vector": 4, "custom": 4, "pg_featureserv": 4, "setup": 4, "load": 4, "depend": 4, "updat": 4, "currenc": 4, "usag": 4, "analysi": 4, "fwa_approx_bord": 4, "fwa_assessment_watersheds_lut": 4, "fwa_assessment_watersheds_streams_lut": 4, "fwa_basins_poli": 4, "fwa_bcboundari": 4, "fwa_named_stream": 4, "fwa_streams_watersheds_lut": 4, "fwa_waterbodies_upstream_area": 4, "fwa_watersheds_upstream_area": 4, "fwa_locatealong": 4, "fwa_locatealonginterv": 4, "fwa_streamsasmvt": 4}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"setup": 0, "data": 0, "load": 0, "depend": 0, "creat": 0, "databas": 0, "environ": 0, "variabl": 0, "updat": 0, "currenc": 0, "usag": 1, "upstream": 1, "downstream": 1, "analysi": 1, "refer": [1, 2, 3], "singl": 1, "point": 1, "stream": 1, "network": 1, "mani": 1, "check": 1, "result": 1, "watersh": 1, "code": 1, "queri": 1, "gener": 1, "tabl": 2, "fwa_approx_bord": 2, "fwa_assessment_watersheds_lut": 2, "fwa_assessment_watersheds_streams_lut": 2, "fwa_basins_poli": 2, "fwa_bcboundari": 2, "fwa_named_stream": 2, "fwa_streams_watersheds_lut": 2, "fwa_waterbodi": 2, "fwa_waterbodies_upstream_area": 2, "fwa_watersheds_upstream_area": 2, "function": 3, "fwa_downstream": 3, "synopsi": 3, "descript": 3, "exampl": 3, "fwa_indexpoint": 3, "option": 3, "web": 3, "servic": 3, "fwa_locatealong": 3, "fwa_locatealonginterv": 3, "fwa_streamsasmvt": 3, "fwa_upstream": 3, "fwa_watershedatmeasur": 3, "fwapg": 4, "content": 4}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 56}})